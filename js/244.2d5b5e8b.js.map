{"version":3,"file":"js/244.2d5b5e8b.js","mappings":"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","sources":["webpack://qianfang/./src/components/Nowplaying/index.vue","webpack://qianfang/src/components/Nowplaying/index.vue","webpack://qianfang/./src/components/Nowplaying/index.vue?f059","webpack://qianfang/./src/components/Nowplaying/index.vue?bbee"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[(_vm.isLoading)?_c('MyLoading'):_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\",\"immediate-check\":false},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.datalist),function(data){return _c('van-cell',{key:data.filmId,staticClass:\"van-cel\",on:{\"click\":function($event){return _vm.handleChangePage(data.filmId)}}},[_c('img',{attrs:{\"src\":data.poster}}),_c('div',{staticClass:\"direFa\"},[_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(data.name)+\" \"+_vm._s(data.filmType.name))]),_c('div',{staticClass:\"content\"},[_c('div',[(data.grade)?_c('span',{staticStyle:{\"color\":\"red\"}},[_vm._v(\"观众评分：\"+_vm._s(data.grade))]):_c('span',[_vm._v(\"暂无评分\")])]),_c('div',[_c('span',[_vm._v(_vm._s(_vm._f(\"dataFilter\")(data.premiereAt))+\" 上映\")])]),_c('div',{staticClass:\"actors\"},[_vm._v(\"主演： \"+_vm._s(_vm._f(\"actorsFilter\")(data.actors)))]),_c('div',[_vm._v(_vm._s(data.nation)+\" | \"+_vm._s(data.runtime)+\"分钟\")])])])])}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <!-- <van-pull-refresh v-model=\"refreshing\" @refresh=\"onRefresh\"> -->\r\n    <MyLoading v-if=\"isLoading\"></MyLoading>\r\n    <van-list\r\n      v-else\r\n      v-model=\"loading\"\r\n      :finished=\"finished\"\r\n      finished-text=\"没有更多了\"\r\n      @load=\"onLoad\"\r\n      :immediate-check=\"false\"\r\n    >\r\n      <van-cell\r\n        v-for=\"data in datalist\"\r\n        :key=\"data.filmId\"\r\n        @click=\"handleChangePage(data.filmId)\"\r\n        class=\"van-cel\"\r\n      >\r\n        <!-- 电影图片 -->\r\n        <img :src=\"data.poster\" />\r\n        <div class=\"direFa\">\r\n          <!-- 电影名字 -->\r\n          <div class=\"title\">{{ data.name }} {{ data.filmType.name }}</div>\r\n          <div class=\"content\">\r\n            <!-- 观众评分 -->\r\n            <div>\r\n              <span style=\"color: red\" v-if=\"data.grade\">观众评分：{{ data.grade }}</span>\r\n              <span v-else>暂无评分</span>\r\n            </div>\r\n            <!-- 电影上映时间 -->\r\n            <div>\r\n              <span>{{ data.premiereAt | dataFilter }} 上映</span>\r\n            </div>\r\n            <!-- 主演 -->\r\n            <div class=\"actors\">主演： {{ data.actors | actorsFilter }}</div>\r\n            <!-- 电影时长 -->\r\n            <div>{{ data.nation }} | {{ data.runtime }}分钟</div>\r\n          </div>\r\n        </div>\r\n      </van-cell>\r\n    </van-list>\r\n    <!-- </van-pull-refresh> -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport Vue from 'vue'\r\nimport moment from 'moment'\r\n\r\nimport http from '@/util/http.js'\r\n\r\n// 定义全局过滤器\r\nVue.filter('actorsFilter', (data) => {\r\n  // console.log()\r\n  if (data === undefined) return '暂无主演'\r\n  return data.map((item) => item.name).join(' ')\r\n})\r\nVue.filter('dataFilter', (date) => {\r\n  return moment(date * 1000).format('YYYY-MM-DD')\r\n})\r\nexport default {\r\n  name: 'NowPlaying',\r\n  data () {\r\n    return {\r\n      datalist: [],\r\n      // 上拉加载\r\n      loading: false,\r\n      finished: false,\r\n      current: 1,\r\n      total: 0,\r\n      prevCityId: -1,\r\n      isLoading: false\r\n      // 下拉刷新\r\n      // refreshing: false\r\n    }\r\n  },\r\n  // activated 替换 mounted ：（activated，在keep-alive组件被激活时调用）\r\n  activated () {\r\n    const cityId = this.$store.state.city.cityId\r\n    if (this.prevCityId === cityId) {\r\n      return\r\n    }\r\n    this.isLoading = true\r\n    http({\r\n      url: `/gateway?cityId=${this.$store.state.city.cityId}&pageNum=1&pageSize=10&type=1&k=5196770`,\r\n      headers: {\r\n        'X-Host': 'mall.film-ticket.film.list'\r\n      }\r\n    }).then((res) => {\r\n      // console.log(res.data.data.films)\r\n      this.datalist = res.data.data.films\r\n      this.total = res.data.data.total\r\n      this.isLoading = false\r\n      this.prevCityId = cityId\r\n    })\r\n  },\r\n  methods: {\r\n    // 上拉加载\r\n    onLoad () {\r\n      if (this.datalist.length === this.total && this.total !== 0) {\r\n        this.finished = true\r\n        return\r\n      }\r\n      this.current++\r\n      axios({\r\n        url:\r\n          'https://m.maizuo.com/gateway?cityId=' +\r\n          this.$store.state.city.cityId +\r\n          '&pageNum=' +\r\n          this.current +\r\n          '&pageSize=10&type=1&k=5196770',\r\n        headers: {\r\n          'X-Client-Info':\r\n            '{\"a\":\"3000\",\"ch\":\"1002\",\"v\":\"5.0.4\",\"e\":\"1606697250632532718583809\",\"bc\":\"440100\"}',\r\n          'X-Host': 'mall.film-ticket.film.list'\r\n        }\r\n      }).then((res) => {\r\n        this.datalist = [...this.datalist, ...res.data.data.films]\r\n        this.loading = false\r\n      })\r\n    },\r\n    // 下拉刷新\r\n    // onRefresh () {\r\n    //   this.finished = true\r\n    //   console.log('下拉刷新了')\r\n    //   // setTimeout(() => {\r\n    //   // this.finished = false\r\n    //   // }, 1000)\r\n    // },\r\n    handleChangePage (id) {\r\n      this.$router.push(`/detail/${id}`)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.van-cell {\r\n  line-height: 20px;\r\n}\r\n.van-list {\r\n  padding-bottom: 1.5556rem;\r\n  .van-cel {\r\n    overflow: hidden;\r\n    padding: 15px;\r\n    img {\r\n      width: 66px;\r\n      float: left;\r\n    }\r\n    .title {\r\n      font-size: 0.8889rem;\r\n    }\r\n    .content {\r\n      font-size: 0.7222rem;\r\n      color: gray;\r\n      .actors {\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n        width: 200px;\r\n      }\r\n    }\r\n    .direFa {\r\n      padding-left: 4.7222rem;\r\n      padding-top: 0.1667rem;\r\n      padding-bottom: 0.1111rem;\r\n    }\r\n  }\r\n}\r\n.hidden {\r\n  visibility: hidden;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=7c0b6b30&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=7c0b6b30&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7c0b6b30\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","isLoading","attrs","finished","on","onLoad","model","value","loading","callback","$$v","expression","_l","datalist","data","key","filmId","staticClass","$event","handleChangePage","poster","_v","_s","name","filmType","grade","staticStyle","_f","premiereAt","actors","nation","runtime","staticRenderFns","Vue","undefined","map","item","join","date","moment","format","current","total","prevCityId","activated","cityId","$store","state","city","http","url","headers","then","res","films","methods","length","axios","id","$router","push","component"],"sourceRoot":""}