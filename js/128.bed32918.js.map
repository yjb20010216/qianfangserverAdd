{"version":3,"file":"js/128.bed32918.js","mappings":"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","sources":["webpack://qianfang/./src/components/City/index.vue","webpack://qianfang/src/components/City/index.vue","webpack://qianfang/./src/components/City/index.vue?c793","webpack://qianfang/./src/components/City/index.vue?39ee"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"city_body\"},[_c('div',{staticClass:\"city_list\"},[(_vm.isLoading)?_c('MyLoading'):_c('div',{staticClass:\"city_hot\"},[_c('h2',[_vm._v(\"热门城市\")]),_c('ul',{staticClass:\"clearfix\"},_vm._l((_vm.hotList),function(item){return _c('li',{key:item.id,on:{\"click\":function($event){return _vm.handleToCity(item.name, item.cityId)}}},[_vm._v(\" \"+_vm._s(item.name)+\" \")])}),0)]),_c('div',{ref:\"city_sort\",staticClass:\"city_sort\"},_vm._l((_vm.cityList),function(item){return _c('div',{key:item.type},[_c('h2',[_vm._v(_vm._s(item.type))]),_c('ul',_vm._l((item.list),function(itemList){return _c('li',{key:itemList.cityId,on:{\"click\":function($event){return _vm.handleToCity(itemList.name, itemList.cityId)}}},[_vm._v(\" \"+_vm._s(itemList.name)+\" \")])}),0)])}),0)],1),_c('div',{staticClass:\"city_index\"},[_c('ul',_vm._l((_vm.cityList),function(item,index){return _c('li',{key:item.type,on:{\"touchstart\":function($event){return _vm.handleToIndex(index)}}},[_vm._v(\" \"+_vm._s(item.type)+\" \")])}),0)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"city_body\">\r\n    <div class=\"city_list\">\r\n      <MyLoading v-if=\"isLoading\"></MyLoading>\r\n      <div class=\"city_hot\" v-else>\r\n        <h2>热门城市</h2>\r\n        <ul class=\"clearfix\">\r\n          <li\r\n            v-for=\"item in hotList\"\r\n            :key=\"item.id\"\r\n            @click=\"handleToCity(item.name, item.cityId)\"\r\n          >\r\n            {{ item.name }}\r\n          </li>\r\n        </ul>\r\n      </div>\r\n      <div class=\"city_sort\" ref=\"city_sort\">\r\n        <div v-for=\"item in cityList\" :key=\"item.type\">\r\n          <h2>{{ item.type }}</h2>\r\n          <ul>\r\n            <li\r\n              v-for=\"itemList in item.list\"\r\n              :key=\"itemList.cityId\"\r\n              @click=\"handleToCity(itemList.name, itemList.cityId)\"\r\n            >\r\n              {{ itemList.name }}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"city_index\">\r\n      <ul>\r\n        <li\r\n          v-for=\"(item, index) in cityList\"\r\n          :key=\"item.type\"\r\n          @touchstart=\"handleToIndex(index)\"\r\n        >\r\n          {{ item.type }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport http from '@/util/http.js'\r\n\r\nexport default {\r\n  name: 'MyCity',\r\n  data () {\r\n    return {\r\n      cityList: [],\r\n      indexList: [],\r\n      hotList: [],\r\n      isLoading: true\r\n    }\r\n  },\r\n  mounted () {\r\n    const cityList = window.localStorage.getItem('cityList')\r\n    const hotList = window.localStorage.getItem('hotList')\r\n    if (cityList && hotList) {\r\n      this.cityList = JSON.parse(cityList)\r\n      this.hotList = JSON.parse(hotList)\r\n      // 让 Loading 加载框消失\r\n      this.isLoading = false\r\n    } else {\r\n      http({\r\n        url: '/gateway?k=1132003',\r\n        headers: {\r\n          'X-Host': 'mall.film-ticket.city.list'\r\n        }\r\n      }).then((res) => {\r\n        // console.log(res.data.data.cities)\r\n        this.renderCity(res.data.data.cities)\r\n        // 让 Loading 加载框消失\r\n        this.isLoading = false\r\n      })\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    // 对请求过来的city数据进行改造\r\n    renderCity (list) {\r\n      const letterList = []\r\n      // 利用 ASCLL值 添加26个大写字母\r\n      for (let i = 65; i < 91; i++) {\r\n        letterList.push(String.fromCharCode(i))\r\n      }\r\n      // 对每个大写字母进行遍历，又对list进行过滤，把拼音首字母一样的放到一起\r\n      letterList.forEach((letter) => {\r\n        const newList = list.filter(\r\n          (item) => item.pinyin[0].toUpperCase() === letter\r\n        )\r\n        if (newList.length > 0) {\r\n          this.cityList.push({ type: letter, list: newList })\r\n          this.indexList.push(letter)\r\n        }\r\n      })\r\n      // 热门城市\r\n      for (let i = 0; i < list.length; i++) {\r\n        if (list[i].isHot === 1) {\r\n          this.hotList.push(list[i])\r\n        }\r\n      }\r\n      // console.log(this.hotList)\r\n      window.localStorage.setItem('cityList', JSON.stringify(this.cityList))\r\n      window.localStorage.setItem('hotList', JSON.stringify(this.hotList))\r\n    },\r\n    // 点击城市字母索引跳转\r\n    handleToIndex (index) {\r\n      const h2 = this.$refs.city_sort.getElementsByTagName('h2')\r\n      console.log(h2[index].offsetTop + 20)\r\n      this.$refs.city_sort.parentNode.scrollTop = h2[index].offsetTop - 20\r\n    },\r\n    // 点击城市跳转到正在热映页面，更新状态管理\r\n    handleToCity (name, cityId) {\r\n      this.$store.commit('city/CITY_INFO', { name, cityId })\r\n      window.localStorage.setItem('nowCityName', name)\r\n      window.localStorage.setItem('nowCityCityId', cityId)\r\n      this.$router.push('/film/nowplaying')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n#content .city_body {\r\n  margin-top: 27px;\r\n  display: flex;\r\n  width: 100%;\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n}\r\n.city_body .city_list {\r\n  flex: 1;\r\n  overflow: auto;\r\n  background: #fff5f0;\r\n}\r\n.city_body .city_list::-webkit-scrollbar {\r\n  background-color: transparent;\r\n  width: 0;\r\n}\r\n.city_body .city_hot {\r\n  margin-top: 28px;\r\n}\r\n.city_body .city_hot h2 {\r\n  padding-left: 15px;\r\n  line-height: 30px;\r\n  font-size: 14px;\r\n  background: #f0f0f0;\r\n  font-weight: normal;\r\n}\r\n\r\n.city_body .city_hot ul li {\r\n  float: left;\r\n  background: #fff;\r\n  width: 29%;\r\n  height: 33px;\r\n  margin-top: 15px;\r\n  margin-left: 3%;\r\n  padding: 0 4px;\r\n  border: 1px solid #e6e6e6;\r\n  border-radius: 3px;\r\n  line-height: 33px;\r\n  text-align: center;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.city_body .city_sort div {\r\n  margin-top: 20px;\r\n}\r\n.city_body .city_sort h2 {\r\n  padding-left: 15px;\r\n  line-height: 30px;\r\n  font-size: 18px;\r\n  background: #f0f0f0;\r\n  font-weight: normal;\r\n}\r\n.city_body .city_sort ul {\r\n  padding-left: 10px;\r\n  margin-top: 10px;\r\n}\r\n.city_body .city_sort ul li {\r\n  line-height: 30px;\r\n  line-height: 30px;\r\n}\r\n.city_body .city_index {\r\n  width: 40px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  text-align: center;\r\n  border-left: 1px #e6e6e6 solid;\r\n}\r\n.city_body .city_index ul li {\r\n  margin-bottom: 5px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=84cd411c&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=84cd411c&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"84cd411c\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","isLoading","_v","_l","hotList","item","key","id","on","$event","handleToCity","name","cityId","_s","ref","cityList","type","list","itemList","index","handleToIndex","staticRenderFns","data","indexList","mounted","window","localStorage","getItem","JSON","parse","http","url","headers","then","res","renderCity","cities","methods","letterList","i","push","String","fromCharCode","forEach","letter","newList","filter","pinyin","toUpperCase","length","isHot","setItem","stringify","h2","$refs","city_sort","getElementsByTagName","console","log","offsetTop","parentNode","scrollTop","$store","commit","$router","component"],"sourceRoot":""}